#!/bin/bash

set -euo pipefail

export CHRONOS_PATH="${CHRONOS_PATH:-$HOME/.local/share/chronos}"


source "$CHRONOS_PATH/scripts/00-prerequisites/gum-install.sh"
source "$CHRONOS_PATH/scripts/00-prerequisites/set-variables.sh"

source "$CHRONOS_PATH/lib/functions.sh"

source "$CHRONOS_PATH/scripts/00-prerequisites/system-update.sh"
source "$CHRONOS_PATH/scripts/00-prerequisites/enable-multilib.sh"

gum_style --foreground="#ff79c6" "Installation complete! Rebooting in 5 seconds..."

# Countdown with cancellation option
for i in {5..1}; do
    echo -n "Rebooting in $i seconds... (Press Ctrl+C to cancel) "
    if read -t 1 -n 1; then
        echo
        gum_style --foreground="#50fa7b" "Reboot canceled."
        exit 0
    fi
    echo
done

gum_style --foreground="#ff79c6" "Rebooting now..."
sudo reboot